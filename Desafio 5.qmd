---
title: "Desafio 5"
author: "Victor de Lima Souza 199335"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## Running Code

When you click the **Render** button a document will be generated that includes both content and the output of embedded code. You can embed code like this:

```{r}
1 + 1
```

You can add options to executable code like this

```{r}
#| echo: false
2 * 2
```

The `echo: false` option disables the printing of code (only output is displayed).

```{r}
install.packages("RSQLite")
library(RSQLite)
db = dbConnect(SQLite(), 'disco.db')
db

```

```{r}
#Selecione as colunas trackid, name, composer e unitprice. Ordene o objeto resultante por unitprice.

resultado <- dbGetQuery(db, "
  SELECT trackid, name, composer, unitprice
  FROM tracks
  ORDER BY unitprice
")

head(resultado)
```

```{r}
#Quais são as cidades de todos os clientes, ordenadas por nome de cidade?
sql = 'SELECT city FROM customers ORDER BY city'
ex3a = dbGetQuery(db, sql)
head(ex3a)
```

```{r}
#Quais são as cidades de todos os clientes, ordenadas por nome de cidade? (sem repetição)
sql = 'SELECT DISTINCT city FROM customers ORDER BY city'
ex3b = dbGetQuery(db, sql)
head(ex3b)

```

```{r}
#Quais são todas as músicas do álbum 1?

dbGetQuery(db,
'SELECT name, albumid FROM tracks WHERE albumid=1')
```

```{r}
#Limitando-se a 5 registros, após ordenação por nome, quais são os nomes, ID de álbum e ID de mídia de músicas com mídias de tipo 1 ou 2?

sql = paste('SELECT name, albumid, mediatypeid FROM tracks'
,
'WHERE mediatypeid IN (1, 2)'
,
'ORDER BY name LIMIT 5')
dbGetQuery(db, sql)

```

```{r}
#Quais são as músicas e identificadores de faixa e álbum produzidas pelo artista que identificador 12?

sql = paste('SELECT trackid, name, albumid FROM tracks'
,
'WHERE albumid IN'
,
'(SELECT albumid FROM albums WHERE artistid==12)'
,
'LIMIT 5')
dbGetQuery(db, sql)

```

```{r}
#Quais são as faixas cujos nomes começam com qualquer caracter seguido de 'ere' e terminam com qualquer expressão?

sql = "SELECT trackid, name FROM tracks WHERE name GLOB '?ere*'"
dbGetQuery(db, sql)[1:5,]
```

```{r}
#Quais são as faixas cujos nomes possuem algum dígito?

sql = "SELECT trackid, name FROM tracks WHERE name GLOB '*[0-9]*'"
dbGetQuery(db, sql)[1:5,]

```

```{r}
#Quantas faixas por disco?
sql = 'SELECT albumid, COUNT(trackid) FROM tracks GROUP BY albumid'
dbGetQuery(db, sql)[1:5,]

```

```{r}
#Quantas faixas por disco para o album 1?
sql = paste('SELECT albumid, COUNT(trackid)'
,
'FROM tracks GROUP BY albumid'
,
'HAVING albumid=1')
dbGetQuery(db, sql)
```

```{r}
#Quais são os nomes de cada faixa com os respectivos títulos dos álbums?

sql = paste('SELECT trackid, name, title FROM tracks'
,
'INNER JOIN albums ON albums.albumid=tracks.albumid')
dbGetQuery(db, sql)[1:5,]
```
